University: ITMO University

Faculty: PIn

Course: IP-telephony

Year: 2024/2025

Group: K34212

Author: Kolesnikova Maria Alexeevna

Lab: Lab3

Date of create: 21.04.2025

Date of finished: 25.04.2025

# Лабораторная работа №3 "Использование Asterisk в качестве SIP proxy"

## Описание
Для выполнения данной лабораторной работы необходимо выполнить настройку Asterisk.

## Цель работы
Изучить программный комплекс Asterisk. Настройка Asterisk для локальных звонков.

## Ход выполнения работы

### Часть 1

1. Работа была выполнена на Ubuntu. Для установки Asterisk были выполнены следующие команды:
```
sudo apt-get update
sudo apt-get install asterisk
```

2. После этого было выполнено редактирование конфигурационных файлов.

Для настройки SIP-каналов необходимо отредактировать файл sip.conf

```bash
[1000]
type=friend
context=default
secret=lab3
host=dynamic

[1001]
type=friend
context=default
secret=lab3
host=dynamic
```
Аналогично был отредактирован extensions.conf

```
[default]
exten => 1000,1,Answer()
exten => 1000,2,Playback(hello-world)
exten => 1000,3,Hangup()

exten => 1001,1,Dial(SIP/1001)
```
3. Следующим шагом является установка софтфон Twinkle.

Было создано два профиля - 1000 и 1001. В качестве SIP-сервера было указано 127.0.0.1, так как Asterisk установлен на этом же хосте. По той же причине был изменен порт для SIP-вызовов в Twinkle на 5070, так как стандартный 5060 уже занят Астериском

При активации профилей они автоматически регистрируются

![Снимок экрана 2025-04-28 135540](https://github.com/user-attachments/assets/0182a966-6e66-42f7-82ba-61b09fea4d6a)


Прежде чем совершать вызов была открыта консоль Asterisk и выполнена команда ```core set verbose 10```, чтобы отследить выполнение вызова на сервере. В Twinkle выбираем пользователя 1001, в поле Call вводим 1000 и звоним. В консоли Asterisk отображается входящий вызов и шаги, которые для него выполняются в соответствии с правилом default: ответ, проигрывание записи hello и сброс звонка 

![Снимок экрана 2025-04-28 135558](https://github.com/user-attachments/assets/2051245a-0809-4f30-92d6-b021549a5073)


Попробуем позвонить с номера 1000 на 1001. Так как действия были прописаны только для вызова на номер 1000, сервер просто пытается соединить клиента 1000 с запрошенным 1001

![Снимок экрана 2025-04-28 135619](https://github.com/user-attachments/assets/764d54ac-1207-4542-b3e8-801bcd7bfbb5)

## Выводы
В ходе выполнения лабораторной работы были установлены и настроены программный сервер телефонии Asterisk и софтфон Twinkle. Было создано два пользователя с номерами 1000 и 1001, регистрация пользователей на сервере и вызовы прошли успешно.
